# CMakeLists.txt for Process Tree Visualizer
# Created by: Michael Semera
# Cross-platform build configuration

cmake_minimum_required(VERSION 3.10)
project(ProcessTreeVisualizer VERSION 1.0.0 LANGUAGES CXX)

# Set C++ standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Compiler flags
if(MSVC)
    add_compile_options(/W4)
else()
    add_compile_options(-Wall -Wextra -pedantic)
endif()

# Source files
set(SOURCES
    process_tree.cpp
)

# Create executable
add_executable(process_tree ${SOURCES})

# Platform-specific libraries
if(WIN32)
    target_link_libraries(process_tree psapi)
elseif(APPLE)
    target_link_libraries(process_tree "-framework CoreFoundation")
endif()

# Installation
install(TARGETS process_tree DESTINATION bin)

# Print build configuration
message(STATUS "Build configuration:")
message(STATUS "  C++ Standard: ${CMAKE_CXX_STANDARD}")
message(STATUS "  Build Type: ${CMAKE_BUILD_TYPE}")
message(STATUS "  System: ${CMAKE_SYSTEM_NAME}")
message(STATUS "  Compiler: ${CMAKE_CXX_COMPILER_ID}")

# Custom target for running
add_custom_target(run
    COMMAND process_tree
    DEPENDS process_tree
    WORKING_DIRECTORY ${CMAKE_PROJECT_DIR}
    COMMENT "Running Process Tree Visualizer..."
)